<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X.N.O.R Bug Fix & Troubleshooting</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="../styles.css">
</head>
<body>

    <header class="top-bar">
        <a href="../index.html" class="back-btn"><i class="fas fa-arrow-left"></i> Fix Issues</a>
        <button id="menu-btn" aria-label="Open Menu">
            <i class="fas fa-ellipsis-v"></i>
        </button>
    </header>

    <div id="menu-overlay" class="menu-overlay">
        <div class="menu-content">
            <button id="close-menu" aria-label="Close Menu"><i class="fas fa-times"></i></button>
            <h2>Settings</h2>
            <!-- your theme switch and menu items -->
            <div class="theme-switch-container">
                <span>Dark/Light Theme:</span>
                <label class="switch">
                    <input type="checkbox" id="theme-switch">
                    <span class="slider round"></span>
                </label>
            </div>
            <hr><br>
            <h3>Download for:</h3>
            <div class="platform-buttons">
                <a href="../android.html" class="platform-btn"><i class="fab fa-android"></i> Android</a>
                <a href="../apple.html" class="platform-btn"><i class="fab fa-apple"></i> Apple</a>
                <a href="../windows.html" class="platform-btn"><i class="fab fa-windows"></i> Windows</a>
                <a href="../mac.html" class="platform-btn"><i class="fab fa-apple"></i> Mac</a>
            </div>
            <hr> <br>
            <h3>About</h3>
            <div class="platform-buttons">
                <a href="../about.html" class="platform-btn"><i class="fas fa-info-circle"></i> About Us</a>
                <a href="fix.html" class="platform-btn"><i class="fas fa-tools"></i> Fix Issues</a>
            </div>
        </div>
    </div>

    <main class="bug-fix-container">
        <div class="form-wrapper">
            <h2><i class="fas fa-bug"></i> Bug Report</h2>
            <p class="form-subtitle">Help us improve XNOR Cloud!</p>

            <form id="bug-report-form" class="contact-form">
                <div class="form-group">
                    <label for="unit-path">Unit Path:</label>
                    <select id="unit-path" required>
                        <option value="" disabled selected>Select category...</option>
                        <option value="Home">Home</option>
                        <option value="Android">Android</option>
                        <option value="Windows">Windows</option>
                        <option value="News">News</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group" id="file-item-group" style="display: none;">
                    <label for="file-item">File Item:</label>
                    <select id="file-item" required disabled>
                        <option value="" disabled selected>Select file...</option>
                    </select>
                </div>

                <div class="form-group" id="problem-issue-group" style="display: none;">
                    <label for="problem-issue">Problem Issue:</label>
                    <select id="problem-issue" required disabled>
                        <option value="" disabled selected>Select problem...</option>
                    </select>
                </div>

                <div class="form-group" id="describe-issue-group" style="display: none;">
                    <label for="describe-issue">Please describe the issue:</label>
                    <textarea id="describe-issue" rows="5" placeholder="Describe the issue in detail..." required></textarea>
                </div>

                <button type="submit" class="submit-btn">
                    <i class="fab fa-whatsapp"></i> Send via WhatsApp
                </button>
            </form>
        </div>
    </main>

    <nav class="bottom-nav">
        <a href="../index.html" class="nav-btn"><i class="fas fa-home"></i><span>Home</span></a>
        <a href="../android.html" class="nav-btn"><i class="fab fa-android"></i><span>Android</span></a>
        <a href="../windows.html" class="nav-btn"><i class="fab fa-windows"></i><span>Windows</span></a>
        <a href="news.html" class="nav-btn"><i class="fas fa-newspaper"></i><span>News</span></a>
    </nav>

    <script src="../main.js"></script>
    <script>
        // Unit files for Android and Windows (using original data, adapted)
        const unitFiles = {
            "Android": ["ReVanced YouTube Music v8.10.52", "MicroG 0.3.1.4.240913"],
            "Windows": ["Windows 10 22H2 (x 64-bit)", "Windows 8.1 (x64)", "Windows 8.1 (x86)", "Windows 7 Pro (32-bit)", "Windows 7 Pro (64-bit)"]
        };

        // Problem issues for each unit path
        const problemIssues = {
            "Home": [
                "Homepage Loading Issue",
                "Navigation bar not working",
                "Searching function broken",
                "Refresh Page Problem",
                "Other"
            ],
            "Android": [
                "Download link not working",
                "App crashing after download",
                "wrong version download",
                "file corrupted / incomplete",
                "slow download speed",
                "Other"
            ],
            "Windows": [
                "Download link not working",
                "App crashing after download",
                "wrong version download",
                "file corrupted / incomplete",
                "slow download speed",
                "Other"
            ],
            "News": [
                "News not uploading",
                "images not loading",
                "old achievements showing",
                "Other"
            ]
        };

        const unitPathSelect = document.getElementById('unit-path');
        const fileItemGroup = document.getElementById('file-item-group');
        const fileItemSelect = document.getElementById('file-item');
        const problemIssueGroup = document.getElementById('problem-issue-group');
        const problemIssueSelect = document.getElementById('problem-issue');
        const describeIssueGroup = document.getElementById('describe-issue-group');
        const describeIssueTextarea = document.getElementById('describe-issue');

        // Reset function to hide all dynamic sections
        function resetForm() {
            fileItemGroup.style.display = 'none';
            fileItemSelect.disabled = true;
            fileItemSelect.innerHTML = '<option value="" disabled selected>Select file...</option>';

            problemIssueGroup.style.display = 'none';
            problemIssueSelect.disabled = true;
            problemIssueSelect.innerHTML = '<option value="" disabled selected>Select problem...</option>';

            describeIssueGroup.style.display = 'none';
            describeIssueTextarea.value = '';
            describeIssueTextarea.required = false;
        }

        // Handle Unit Path change
        unitPathSelect.addEventListener('change', () => {
            const selectedUnit = unitPathSelect.value;
            resetForm();

            if (selectedUnit === 'Other') {
                // For Other: Hide Problem Issue, show Describe Issue
                problemIssueGroup.style.display = 'none';
                describeIssueGroup.style.display = 'block';
                describeIssueTextarea.required = true;
                return;
            }

            // For Home, Android, Windows, News: Show File Item if applicable, then Problem Issue
            if (['Android', 'Windows'].includes(selectedUnit)) {
                fileItemGroup.style.display = 'block';
                fileItemSelect.disabled = false;
                fileItemSelect.innerHTML = '<option value="" disabled selected>Select file...</option>';
                if (unitFiles[selectedUnit]) {
                    unitFiles[selectedUnit].forEach(file => {
                        const opt = document.createElement('option');
                        opt.value = file;
                        opt.textContent = file;
                        fileItemSelect.appendChild(opt);
                    });
                }
            }

            problemIssueGroup.style.display = 'block';
            problemIssueSelect.disabled = false;
            problemIssueSelect.innerHTML = '<option value="" disabled selected>Select problem...</option>';
            if (problemIssues[selectedUnit]) {
                problemIssues[selectedUnit].forEach(issue => {
                    const opt = document.createElement('option');
                    opt.value = issue;
                    opt.textContent = issue;
                    problemIssueSelect.appendChild(opt);
                });
            }
        });

        // Handle File Item change (for Android/Windows) - just enables Problem Issue if not already
        fileItemSelect.addEventListener('change', () => {
            if (fileItemSelect.value && !problemIssueGroup.style.display || problemIssueGroup.style.display === 'none') {
                problemIssueGroup.style.display = 'block';
                problemIssueSelect.disabled = false;
            }
        });

        // Handle Problem Issue change
        problemIssueSelect.addEventListener('change', () => {
            const selectedProblem = problemIssueSelect.value;
            if (selectedProblem === 'Other') {
                // For Other in Problem Issue: Show Describe Issue, but DO NOT hide Problem Issue
                describeIssueGroup.style.display = 'block';
                describeIssueTextarea.required = true;
            } else {
                // Hide Describe Issue if not Other
                describeIssueGroup.style.display = 'none';
                describeIssueTextarea.required = false;
                describeIssueTextarea.value = '';
            }
        });

        // Form submit
        document.getElementById('bug-report-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const unit = unitPathSelect.options[unitPathSelect.selectedIndex].text;
            let message = `*Bug Report from X.N.O.R User:*\n\n*Unit Path:* ${unit}`;

            if (unit !== 'Other') {
                const file = fileItemSelect.value || 'N/A';
                if (file !== 'N/A') {
                    message += `\n*File Item:* ${file}`;
                }
                const problem = problemIssueSelect.value || 'N/A';
                if (problem !== 'N/A') {
                    message += `\n*Problem Issue:* ${problem}`;
                }
                if (describeIssueTextarea.value.trim() && problemIssueSelect.value === 'Other') {
                    message += `\n*Please describe the issue:*\n${describeIssueTextarea.value.trim()}`;
                }
            } else {
                if (describeIssueTextarea.value.trim()) {
                    message += `\n*Please describe the issue:*\n${describeIssueTextarea.value.trim()}`;
                } else {
                    alert('Please describe the issue.');
                    return;
                }
            }

            if (!message.includes('describe the issue') && !message.includes('Problem Issue:')) {
                alert('Please select a problem issue or describe it.');
                return;
            }

            message += `\n\n> *X.N.O.R Cloudâ„¢*`;
            const url = `https://wa.me/94741148480?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
            this.reset();
            resetForm();
            unitPathSelect.value = '';
            alert('Thank you! Report sent successfully ðŸŽ‰');
        });
    </script>
</body>
</html>